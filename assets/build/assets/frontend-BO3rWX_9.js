var l=Object.defineProperty;var m=(i,e,t)=>e in i?l(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>m(i,typeof e!="symbol"?e+"":e,t);import{c as d,j as s,P as c}from"./player.es-CajtPz-0.js";function p({player:i,vimeoId:e,times:t}){return s.jsxs("div",{children:[s.jsxs("p",{children:["Vimeo Id: ",e]}),s.jsxs("p",{children:["Start Time: ",t.start]}),s.jsxs("p",{children:["End Time: ",t.end]}),s.jsx("button",{onClick:()=>i.setCurrentTime(t.start),children:"Set Start Time"}),s.jsx("button",{onClick:()=>i.setCurrentTime(t.end),children:"Set End Time"})]})}function h(i,e){d.createRoot(i).render(s.jsx(p,{...e}))}class u{constructor(){a(this,"loaded",!1);a(this,"vimeoId");a(this,"player");a(this,"startTime");a(this,"endTime")}shouldUse(){const e=new URLSearchParams(window.location.search),t=e.get(this.vimeoClipParamKey(e));return!!document.querySelector(`iframe[src*='${t}']`)}init(){var t;console.log("Starting the skip to clip plugin");const e=new URLSearchParams(window.location.search);this.vimeoId=(t=e.get(this.vimeoClipParamKey(e)))==null?void 0:t.toString(),this.loadPlayer(this.vimeoId)}loadPlayer(e){if(this.player)return this.player;{const t=document.querySelector(`iframe[src*='${e}']`);this.player=new c(t),this.player.on("loaded",()=>{this.loaded=!0,this.startPlugin()})}}startPlugin(){if(!this.loaded)throw new Error("Vimeo Plugin has not been properly loaded, need to call loadPlayer before startPlugin");this.setTimes(),this.mountApp()}setTimes(){const e=new URLSearchParams(window.location.search),t=e.has("start")?"start":"ts",r=parseInt(e.get(t)??"0"),n=e.has("end")?"end":"end-ts",o=parseInt(e.get(n)??"0");r&&this.player.setCurrentTime(r),this.startTime=r,this.endTime=o}mountApp(){const e=document.createElement("div");e.id="aim-clip-player-app";const r=document.querySelector(`iframe[src*='${this.vimeoId}']`).closest(".wp-block-embed");if(!r)throw new Error("Could not find wrapper element");r.appendChild(e),h(e,{player:this.player,vimeoId:this.vimeoId,times:{start:this.startTime??0,end:this.endTime??-1}})}vimeoClipParamKey(e){return e.has("aim-clip")?"aim-clip":"skip-to-clip-video"}}window.aimVimeoPlugins||(window.aimVimeoPlugins=[]);window.aimVimeoPlugins.push({aimClipPlayer:new u});
